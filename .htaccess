# Enable Rewrite Engine
<IfModule mod_rewrite.c>
RewriteEngine On

# Block known bad bots by User-Agent
RewriteCond %{HTTP_USER_AGENT} (AhrefsBot|SemrushBot|MJ12bot|DotBot|spider|crawler|scraper|python-requests|curl|wget) [NC]
RewriteRule .* - [F,L]

# Block empty user agents (most spam bots)
RewriteCond %{HTTP_USER_AGENT} ^-?$
RewriteRule .* - [F,L]

# Block too many requests from same IP (basic rate limit)
<IfModule mod_ratelimit.c>
  SetOutputFilter RATE_LIMIT
  SetEnv rate-limit 400
</IfModule>

# Protect sensitive folders
RedirectMatch 403 ^/(vendor|cgi-bin|tmp|logs|backups|admin)/

# âœ… FIX: Allow images (no hotlink blocking here, so direct access works)
# (If you want hotlink protection later, we can add only with nectorflare.com whitelist)

# Deny access to xmlrpc.php (WordPress exploit protection, safe even if PHP app)
<Files "xmlrpc.php">
Order Allow,Deny
Deny from all
</Files>

# Custom error for blocked bots
ErrorDocument 403 "Access Denied"
</IfModule>

